# NNSplitter 

Welcome to the NNSplitter project! This repository contains the core code for NNSplitter, a tool that actively protects the DNN model by splitting it into two parts: the obfuscated model that performs poorly due to weight obfuscation, and the model secrets consisting of the indexes and original values of the obfuscated weights, which can only be accessed by authorized users with the support of the trusted execution environment (TEEï¼‰. Please note that our method can be applied to any pre-trained models and this repository does not include any specific one. However, you can find the model with pre-trained weights on open-sourced GitHub projects (for example, https://github.com/huyvnphan/PyTorch_CIFAR10). For details of this work, please refer to the paper available at https://proceedings.mlr.press/v202/zhou23h.html.

## Requirements

Before getting started, make sure you have the following dependencies installed:

- Python 3.6
- torch 1.10

## Code Structure

The core code of NNSplitter is organized into the following files:

- `controller_rnn.py`: This file contains the implementation of a recurrent neural network (RNN) controller that utilizes the REINFORCE algorithm to generate desired parameters.

- `train.py`: This script is used to train the victim model with the goal of reducing its accuracy.

- `main_cifar.py`: In this file, you can optimize the victim model using the parameters generated by the controller.

- `utilis.py`: Here, you will find various helper functions that assist in the processing of text splitting.

Feel free to explore the code and modify it according to your needs.

## Getting Started

To start using NNSplitter, follow these steps:

1. Ensure that you have met the requirements mentioned above.

2. Obtain the pre-trained model with weights and change the model import path.

3. Clone this repository to your local machine:

   ```bash
   git clone https://github.com/Tongzhou0101/NNSplitter

## Cite

If you find this work or code helpful, please cite us:

```bibtex
@InProceedings{pmlr-v202-zhou23h,
  title = 	 {{NNS}plitter: An Active Defense Solution for {DNN} Model via Automated Weight Obfuscation},
  author =       {Zhou, Tong and Luo, Yukui and Ren, Shaolei and Xu, Xiaolin},
  booktitle = 	 {Proceedings of the 40th International Conference on Machine Learning},
  pages = 	 {42614--42624},
  year = 	 {2023},
  editor = 	 {Krause, Andreas and Brunskill, Emma and Cho, Kyunghyun and Engelhardt, Barbara and Sabato, Sivan and Scarlett, Jonathan},
  volume = 	 {202},
  series = 	 {Proceedings of Machine Learning Research},
  month = 	 {23--29 Jul},
  publisher =    {PMLR}
}
```
